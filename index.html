<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Absen Siswa</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }

        form {
            max-width: 400px;
            margin: auto;
        }

        input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
        }
        button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background-color: aquamarine;
            border-radius: 8px;
        }

        .data {
            margin-top: 20px;
            padding: 10px;
            background: #f0f8ff;
        }

        .checkbox-group {
            text-align: left;
        }
    </style>
</head>

<body>
    <h1>Form Absen Siswa</h1>

    <form id="absenForm">
        <input type="text" id="NIS" placeholder="Masukkan NIS" required>
        <br>
        <label>Pelanggaran:</label><br>
        <input type="checkbox" name="pelanggaran" value="Pelanggaran 1"> Pelanggaran 1
        <input type="checkbox" name="pelanggaran" value="Pelanggaran 2"> Pelanggaran 2
        <input type="checkbox" name="pelanggaran" value="Pelanggaran 3"> Pelanggaran 3
        <input type="checkbox" name="pelanggaran" value="Pelanggaran 4"> Pelanggaran 4
        <br>
        <button type="submit">Submit</button>
    </form>


    <div id="response" class="data" style="font-weight: bold;"></div>

    <script>
        document.getElementById('absenForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const NIS = document.getElementById('NIS').value;
            const checkboxes = document.getElementsByName('pelanggaran');
            const pelanggaranArray = [];

            for (let i = 0; i < checkboxes.length; i++) {
                if (checkboxes[i].checked) {
                    pelanggaranArray.push(checkboxes[i].value);
                }
            }

            const pelanggaran = pelanggaranArray.join(', ');

            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbyfUr3XEm78qd_f5rka5Rgl0W9_zEQCAHQyoeBY8qYK9kwdMFLcWlDXpjtsjRm56VcsPQ/exec', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: `NIS=${encodeURIComponent(NIS)}&pelanggaran=${encodeURIComponent(pelanggaran)}`
                });

                const result = await response.text();
                const data = JSON.parse(result);

                if (data.message) {
                    document.getElementById('response').innerText = data.message;
                } else {
                    document.getElementById('response').innerHTML = `
                        
                        NIS: ${data.nis}<br>
                        Nama: ${data.nama}<br>
                        Jenis Kelamin: ${data.jenis_kelamin}<br>
                        Agama: ${data.agama}<br>
                        Ket: ${data.ket}<br>
                        Pelanggaran: ${data.pelanggaran}
                    `;
                }
                document.getElementById('absenForm').reset();
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('response').innerText = "Terjadi kesalahan saat mengirim data.";
            }
        });
    </script>

</body>

</html>